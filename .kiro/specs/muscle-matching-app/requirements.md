# Requirements Document

## Introduction

マッチョ専用マッチングアプリは、筋トレ・フィットネス愛好者に特化したマッチングプラットフォームです。男性ユーザーは厳格な審査制を導入し、質の高いマッチング環境を提供します。このアプリはTinder風のスワイプ機能をベースとし、筋肉特化型のマッチングサービスを実現します。

## Requirements

### Requirement 1: ユーザー登録・認証システム

**User Story:** ユーザーとして、アプリにすぐにアクセスし、段階的に機能を解放していくために、柔軟な認証プロセスを利用したい。

#### Acceptance Criteria

1. WHEN 新規ユーザーが登録を開始する THEN システムはメールアドレスとパスワードによる基本登録を提供する
2. WHEN ユーザーが基本登録を完了する THEN システムはプロフィール登録画面へ自動的に誘導する
3. WHEN ユーザーが基本的なプロフィール情報を入力する THEN システムはスワイプ機能へのアクセスを許可する
3. WHEN マッチしたユーザーがメッセージを送信しようとする THEN システムは身分証明書のアップロードを要求する
4. WHEN 男性ユーザーが身分証明書を提出する THEN システムは筋肉確認のための写真アップロードも要求する
5. WHEN 管理者が身分証明書を審査する THEN システムは審査結果（承認/却下）を記録し、ユーザーに通知する
6. WHEN 管理者が男性ユーザーの筋肉写真を審査する THEN システムは審査結果を記録し、ユーザーに通知する
7. IF 身分証明書の審査が承認される THEN システムはメッセージング機能へのアクセスを許可する
8. IF 男性ユーザーの筋肉審査が却下される THEN システムはマッチング機能へのアクセスを制限する

### Requirement 2: プロフィール管理システム

**User Story:** ユーザーとして、自分の魅力や特徴を効果的にアピールするために、詳細なプロフィール情報を設定・編集したい。

#### Acceptance Criteria

1. WHEN ユーザーがプロフィール作成画面にアクセスする THEN システムは必須項目（ニックネーム、性別、生年月日、所在地、自己紹介）の入力フォームを表示する
2. WHEN ユーザーがプロフィール写真をアップロードする THEN システムは複数枚の写真を保存し表示する
3. WHEN ユーザーが体型・身体情報を入力する THEN システムは身長、体重、体脂肪率、体型タイプを保存する
4. WHEN ユーザーがトレーニング情報を入力する THEN システムはスクワット、ベンチプレス、デッドリフトの最大重量を保存する
5. WHEN ユーザーがライフスタイル情報を入力する THEN システムは喫煙状況、性格・特徴、休日の過ごし方を保存する
6. WHEN ユーザーがマッチング設定を行う THEN システムは探している関係性の情報を保存する
7. WHEN ユーザーがプロフィールを編集する THEN システムは変更内容を即時に反映する

### Requirement 3: マッチングシステム

**User Story:** ユーザーとして、自分の好みに合った相手を効率的に見つけるために、直感的なマッチング機能を使用したい。

#### Acceptance Criteria

1. WHEN ユーザーがマッチング画面にアクセスする THEN システムはTinder風の左右スワイプインターフェースを表示する
2. WHEN ユーザーが他のユーザーに「いいね」を送る THEN システムはその情報を記録する
3. WHEN 相互に「いいね」が行われる THEN システムはマッチングを成立させ、両ユーザーに通知する
4. WHEN ユーザーが検索フィルターを設定する THEN システムは年齢、所在地、体型、トレーニング経験等の条件に基づいてユーザーを絞り込む
5. WHEN ユーザーがマッチ履歴を確認する THEN システムはマッチしたユーザーの一覧を表示する
6. IF フリープランユーザーが1日の「いいね」制限に達する THEN システムはそれ以上の「いいね」を制限する
7. IF プレミアムユーザーが「いいね」を送る THEN システムは回数制限なく処理する

### Requirement 4: メッセージングシステム

**User Story:** マッチしたユーザーとして、相手とコミュニケーションを取るために、リアルタイムでメッセージをやり取りしたい。

#### Acceptance Criteria

1. WHEN マッチしたユーザー同士がチャット画面にアクセスする THEN システムはリアルタイムメッセージング機能を提供する
2. WHEN ユーザーがメッセージを送信する THEN システムは相手のチャット画面にリアルタイムでメッセージを表示する
3. WHEN メッセージが相手に届く THEN システムは既読・未読状態を管理する
4. WHEN ユーザーが画像を送信する THEN システムはチャット内で画像を表示する
5. WHEN ユーザーが過去のメッセージを確認する THEN システムはメッセージ履歴を時系列で表示する
6. IF プレミアムユーザーがメッセージを確認する THEN システムは既読確認機能を提供する

### Requirement 5: 管理者システム

**User Story:** 管理者として、アプリの品質を維持するために、ユーザー審査と管理機能を使用したい。

#### Acceptance Criteria

1. WHEN 管理者が審査画面にアクセスする THEN システムは審査待ちユーザーの一覧を表示する
2. WHEN 管理者が身分証明書を審査する THEN システムは承認・却下の選択と理由の入力を可能にする
3. WHEN 管理者が男性ユーザーの筋肉写真を審査する THEN システムは承認・却下の選択と理由の入力を可能にする
4. WHEN 管理者がユーザー一覧にアクセスする THEN システムは全ユーザーの検索・フィルタリング機能を提供する
5. WHEN 管理者がユーザーの権限レベルを変更する THEN システムはユーザーの権限を更新する
6. WHEN 管理者が規約違反ユーザーを発見する THEN システムはユーザーの一時停止・永久停止機能を提供する
7. WHEN 管理者が統計情報を確認する THEN システムはユーザー数、マッチング数等の分析データを表示する

### Requirement 6: 課金システム

**User Story:** ユーザーとして、より高度な機能を利用するために、プレミアム機能にアップグレードしたい。

#### Acceptance Criteria

1. WHEN ユーザーがプレミアムプランを選択する THEN システムはStripeを通じて決済処理を行う
2. WHEN ユーザーが決済を完了する THEN システムはプレミアム機能（無制限いいね、追加フィルター、優先表示、既読機能）へのアクセスを許可する
3. WHEN プレミアムユーザーが決済履歴を確認する THEN システムは課金履歴を表示する
4. WHEN サブスクリプションの更新日が近づく THEN システムはユーザーに通知を送信する
5. IF ユーザーがサブスクリプションをキャンセルしない THEN システムは自動的に更新処理を行う
6. IF 決済が失敗する THEN システムはユーザーに通知し、再試行または別の支払い方法を提案する

### Requirement 7: 通知システム

**User Story:** ユーザーとして、アプリの重要な更新や活動を見逃さないために、適切な通知を受け取りたい。

#### Acceptance Criteria

1. WHEN 新しいマッチが成立する THEN システムはプッシュ通知とアプリ内通知を送信する
2. WHEN 新しいメッセージを受信する THEN システムはプッシュ通知を送信する
3. WHEN 審査結果が出る THEN システムはメール通知とアプリ内通知を送信する
4. WHEN システムメンテナンスが予定される THEN システムは事前にアプリ内通知とメール通知を送信する
5. WHEN ユーザーが通知設定を変更する THEN システムは設定に基づいて通知動作を調整する
6. IF ユーザーがアプリを長期間使用していない THEN システムは再訪を促す通知を送信する